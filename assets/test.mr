import "engine_sim.mr"

build_engine engine()

_crankshaft c0()
rod_journal rj0(angle: 0.0)
rod_journal rj1(angle: 0.0)
rod_journal rj2(angle: 0.0)
rod_journal rj3(angle: 0.0)

c0
    .add_rod_journal(rj0)
    .add_rod_journal(rj1)
    .add_rod_journal(rj2)
    .add_rod_journal(rj3)

piston_parameters piston_params(
    mass: 0.0,
    blowby: 0.0,
    compression_height: 0.0,
    wrist_pin_position: 0.0,
    displacement: 0.0
)
connecting_rod_parameters cr_params(
    mass: 0.0,
    moment_of_inertia: 0.0,
    center_of_mass: 0.0,
    length: 0.0
)
cylinder_bank_parameters bank_params(
    angle: 0.0,
    bore: 0.0,
    deck_height: 0.0
)
cylinder_bank b0(bank_params, angle: 0.0)
cylinder_bank b1(bank_params, angle: 0.0)

b0
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj0
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj1
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj2
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj3
    )

b1
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj0
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj1
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj2
    )
    .add_cylinder(
        piston: piston(piston_params),
        connecting_rod: connecting_rod(cr_params),
        rod_journal: rj3
    )

engine
    .add_cylinder_bank(b0)
    .add_cylinder_bank(b1)

engine.add_crankshaft(c0)

function cam_lift(10 * units.deg)
cam_lift.add_sample(0.0 * units.deg, 578.0 * units::thou)
cam_lift.add_sample(10.0 * units.deg, 560.0 * units::thou)
cam_lift.add_sample(-10.0 * units.deg, 560.0 * units::thou)
cam_lift.add_sample(20.0 * units.deg, 510.0 * units::thou)
cam_lift.add_sample(-20.0 * units.deg, 510.0 * units::thou)
cam_lift.add_sample(30.0 * units.deg, 430.0 * units::thou)
cam_lift.add_sample(-30.0 * units.deg, 430.0 * units::thou)
cam_lift.add_sample(40.0 * units.deg, 350.0 * units::thou)
cam_lift.add_sample(-40.0 * units.deg, 350.0 * units::thou)
cam_lift.add_sample(50.0 * units.deg, 220.0 * units::thou)
cam_lift.add_sample(-50.0 * units.deg, 220.0 * units::thou)
cam_lift.add_sample(60.0 * units.deg, 75.0 * units::thou)
cam_lift.add_sample(-60.0 * units.deg, 75.0 * units::thou)
cam_lift.add_sample(70.0 * units.deg, 0.0 * units::thou)
cam_lift.add_sample(-70.0 * units.deg, 0.0 * units::thou)
cam_lift.add_sample(80.0 * units.deg, 0.0 * units::thou)
cam_lift.add_sample(-80.0 * units.deg, 0.0 * units::thou)

camshaft_parameters cam_params(
    advance: 3.0 * units.deg,
    base_radius: 1.0 * units.inch,
    lobe_profile: cam_lift
)
camshaft exhaust_cam_0(cam_params)
camshaft exhaust_cam_1(cam_params)
camshaft intake_cam_0(cam_params)
camshaft intake_cam_1(cam_params)

exhaust_cam_0
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)

exhaust_cam_1
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)

intake_cam_0
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)

intake_cam_1
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)
    .add_lobe(0)

set_engine(
    engine: engine
)
